<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Name injection with "{" and "{{" — glue-operators • rlang</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Source_Sans_Pro-0.4.10/font.css" rel="stylesheet"><link href="../deps/Source_Code_Pro-0.4.10/font.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Name injection with " and glue-operators><meta name="description" content="Dynamic dots (and data-masked dots which are dynamic by default) have built-in support for names interpolation with the glue package.
tibble::tibble(foo = 1)
#&amp;gt; # A tibble: 1 x 1
#&amp;gt;     foo
#&amp;gt;   &amp;lt;dbl&amp;gt;
#&amp;gt; 1     1

foo &amp;lt;- &quot;name&quot;
tibble::tibble(&quot;{foo}&quot; := 1)
#&amp;gt; # A tibble: 1 x 1
#&amp;gt;    name
#&amp;gt;   &amp;lt;dbl&amp;gt;
#&amp;gt; 1     1

Inside functions, embracing an argument with {{ inserts the expression supplied as argument in the string. This gives an indication on the variable or computation supplied as argument:
tib &amp;lt;- function(x) {
  tibble::tibble(&quot;var: {{ x }}&quot; := x)
}

tib(1 + 1)
#&amp;gt; # A tibble: 1 x 1
#&amp;gt;   `var: 1 + 1`
#&amp;gt;          &amp;lt;dbl&amp;gt;
#&amp;gt; 1            2

See also englue() to string-embrace outside of dynamic dots.
g &amp;lt;- function(x) {
  englue(&quot;var: {{ x }}&quot;)
}

g(1 + 1)
#&amp;gt; [1] &quot;var: 1 + 1&quot;

Technically, &quot;{{&quot; defuses a function argument, calls as_label() on the expression supplied as argument, and inserts the result in the string.
&quot;{&quot; and &quot;{{&quot;


While glue::glue() only supports &quot;{&quot;, dynamic dots support both &quot;{&quot; and &quot;{{&quot;. The double brace variant is similar to the embrace operator {{ available in data-masked arguments.
In the following example, the embrace operator is used in a glue string to name the result with a default name that represents the expression supplied as argument:
my_mean &amp;lt;- function(data, var) {
  data %&amp;gt;% dplyr::summarise(&quot;{{ var }}&quot; := mean({{ var }}))
}

mtcars %&amp;gt;% my_mean(cyl)
#&amp;gt; # A tibble: 1 x 1
#&amp;gt;     cyl
#&amp;gt;   &amp;lt;dbl&amp;gt;
#&amp;gt; 1  6.19

mtcars %&amp;gt;% my_mean(cyl * am)
#&amp;gt; # A tibble: 1 x 1
#&amp;gt;   `cyl * am`
#&amp;gt;        &amp;lt;dbl&amp;gt;
#&amp;gt; 1       2.06

&quot;{{&quot; is only meant for inserting an expression supplied as argument to a function. The result of the expression is not inspected or used. To interpolate a string stored in a variable, use the regular glue operator &quot;{&quot; instead:
my_mean &amp;lt;- function(data, var, name = &quot;mean&quot;) {
  data %&amp;gt;% dplyr::summarise(&quot;{name}&quot; := mean({{ var }}))
}

mtcars %&amp;gt;% my_mean(cyl)
#&amp;gt; # A tibble: 1 x 1
#&amp;gt;    mean
#&amp;gt;   &amp;lt;dbl&amp;gt;
#&amp;gt; 1  6.19

mtcars %&amp;gt;% my_mean(cyl, name = &quot;cyl&quot;)
#&amp;gt; # A tibble: 1 x 1
#&amp;gt;     cyl
#&amp;gt;   &amp;lt;dbl&amp;gt;
#&amp;gt; 1  6.19

Using the wrong operator causes unexpected results:
x &amp;lt;- &quot;name&quot;

list2(&quot;{{ x }}&quot; := 1)
#&amp;gt; $`&quot;name&quot;`
#&amp;gt; [1] 1

list2(&quot;{x}&quot; := 1)
#&amp;gt; $name
#&amp;gt; [1] 1

Ideally, using {{ on regular objects would be an error. However for technical reasons it is not possible to make a distinction between function arguments and ordinary variables. See Does {{ work on regular objects? for more information about this limitation.



Allow overriding default names


The implementation of my_mean() in the previous section forces a default name onto the result. But what if the caller wants to give it a different name? In functions that take dots, it is possible to just supply a named expression to override the default. In a function like my_mean() that takes a named argument we need a different approach.
This is where englue() becomes useful. We can pull out the default name creation in another user-facing argument like this:
my_mean &amp;lt;- function(data, var, name = englue(&quot;{{ var }}&quot;)) {
  data %&amp;gt;% dplyr::summarise(&quot;{name}&quot; := mean({{ var }}))
}

Now the user may supply their own name if needed:
mtcars %&amp;gt;% my_mean(cyl * am)
#&amp;gt; # A tibble: 1 x 1
#&amp;gt;   `cyl * am`
#&amp;gt;        &amp;lt;dbl&amp;gt;
#&amp;gt; 1       2.06

mtcars %&amp;gt;% my_mean(cyl * am, name = &quot;mean_cyl_am&quot;)
#&amp;gt; # A tibble: 1 x 1
#&amp;gt;   mean_cyl_am
#&amp;gt;         &amp;lt;dbl&amp;gt;
#&amp;gt; 1        2.06




What's the deal with :=?


Name injection in dynamic dots was originally implemented with := instead of = to allow complex expressions on the LHS:
x &amp;lt;- &quot;name&quot;
list2(!!x := 1)
#&amp;gt; $name
#&amp;gt; [1] 1

Name-injection with glue operations was an extension of this existing feature and so inherited the same interface. However, there is no technical barrier to using glue strings on the LHS of =.



Using glue syntax in packages


Since rlang does not depend directly on glue, you will have to ensure that glue is installed by adding it to your Imports: section.
usethis::use_package(&quot;glue&quot;, &quot;Imports&quot;)


"><meta property="og:description" content="Dynamic dots (and data-masked dots which are dynamic by default) have built-in support for names interpolation with the glue package.
tibble::tibble(foo = 1)
#&amp;gt; # A tibble: 1 x 1
#&amp;gt;     foo
#&amp;gt;   &amp;lt;dbl&amp;gt;
#&amp;gt; 1     1

foo &amp;lt;- &quot;name&quot;
tibble::tibble(&quot;{foo}&quot; := 1)
#&amp;gt; # A tibble: 1 x 1
#&amp;gt;    name
#&amp;gt;   &amp;lt;dbl&amp;gt;
#&amp;gt; 1     1

Inside functions, embracing an argument with {{ inserts the expression supplied as argument in the string. This gives an indication on the variable or computation supplied as argument:
tib &amp;lt;- function(x) {
  tibble::tibble(&quot;var: {{ x }}&quot; := x)
}

tib(1 + 1)
#&amp;gt; # A tibble: 1 x 1
#&amp;gt;   `var: 1 + 1`
#&amp;gt;          &amp;lt;dbl&amp;gt;
#&amp;gt; 1            2

See also englue() to string-embrace outside of dynamic dots.
g &amp;lt;- function(x) {
  englue(&quot;var: {{ x }}&quot;)
}

g(1 + 1)
#&amp;gt; [1] &quot;var: 1 + 1&quot;

Technically, &quot;{{&quot; defuses a function argument, calls as_label() on the expression supplied as argument, and inserts the result in the string.
&quot;{&quot; and &quot;{{&quot;


While glue::glue() only supports &quot;{&quot;, dynamic dots support both &quot;{&quot; and &quot;{{&quot;. The double brace variant is similar to the embrace operator {{ available in data-masked arguments.
In the following example, the embrace operator is used in a glue string to name the result with a default name that represents the expression supplied as argument:
my_mean &amp;lt;- function(data, var) {
  data %&amp;gt;% dplyr::summarise(&quot;{{ var }}&quot; := mean({{ var }}))
}

mtcars %&amp;gt;% my_mean(cyl)
#&amp;gt; # A tibble: 1 x 1
#&amp;gt;     cyl
#&amp;gt;   &amp;lt;dbl&amp;gt;
#&amp;gt; 1  6.19

mtcars %&amp;gt;% my_mean(cyl * am)
#&amp;gt; # A tibble: 1 x 1
#&amp;gt;   `cyl * am`
#&amp;gt;        &amp;lt;dbl&amp;gt;
#&amp;gt; 1       2.06

&quot;{{&quot; is only meant for inserting an expression supplied as argument to a function. The result of the expression is not inspected or used. To interpolate a string stored in a variable, use the regular glue operator &quot;{&quot; instead:
my_mean &amp;lt;- function(data, var, name = &quot;mean&quot;) {
  data %&amp;gt;% dplyr::summarise(&quot;{name}&quot; := mean({{ var }}))
}

mtcars %&amp;gt;% my_mean(cyl)
#&amp;gt; # A tibble: 1 x 1
#&amp;gt;    mean
#&amp;gt;   &amp;lt;dbl&amp;gt;
#&amp;gt; 1  6.19

mtcars %&amp;gt;% my_mean(cyl, name = &quot;cyl&quot;)
#&amp;gt; # A tibble: 1 x 1
#&amp;gt;     cyl
#&amp;gt;   &amp;lt;dbl&amp;gt;
#&amp;gt; 1  6.19

Using the wrong operator causes unexpected results:
x &amp;lt;- &quot;name&quot;

list2(&quot;{{ x }}&quot; := 1)
#&amp;gt; $`&quot;name&quot;`
#&amp;gt; [1] 1

list2(&quot;{x}&quot; := 1)
#&amp;gt; $name
#&amp;gt; [1] 1

Ideally, using {{ on regular objects would be an error. However for technical reasons it is not possible to make a distinction between function arguments and ordinary variables. See Does {{ work on regular objects? for more information about this limitation.



Allow overriding default names


The implementation of my_mean() in the previous section forces a default name onto the result. But what if the caller wants to give it a different name? In functions that take dots, it is possible to just supply a named expression to override the default. In a function like my_mean() that takes a named argument we need a different approach.
This is where englue() becomes useful. We can pull out the default name creation in another user-facing argument like this:
my_mean &amp;lt;- function(data, var, name = englue(&quot;{{ var }}&quot;)) {
  data %&amp;gt;% dplyr::summarise(&quot;{name}&quot; := mean({{ var }}))
}

Now the user may supply their own name if needed:
mtcars %&amp;gt;% my_mean(cyl * am)
#&amp;gt; # A tibble: 1 x 1
#&amp;gt;   `cyl * am`
#&amp;gt;        &amp;lt;dbl&amp;gt;
#&amp;gt; 1       2.06

mtcars %&amp;gt;% my_mean(cyl * am, name = &quot;mean_cyl_am&quot;)
#&amp;gt; # A tibble: 1 x 1
#&amp;gt;   mean_cyl_am
#&amp;gt;         &amp;lt;dbl&amp;gt;
#&amp;gt; 1        2.06




What's the deal with :=?


Name injection in dynamic dots was originally implemented with := instead of = to allow complex expressions on the LHS:
x &amp;lt;- &quot;name&quot;
list2(!!x := 1)
#&amp;gt; $name
#&amp;gt; [1] 1

Name-injection with glue operations was an extension of this existing feature and so inherited the same interface. However, there is no technical barrier to using glue strings on the LHS of =.



Using glue syntax in packages


Since rlang does not depend directly on glue, you will have to ensure that glue is installed by adding it to your Imports: section.
usethis::use_package(&quot;glue&quot;, &quot;Imports&quot;)


"><meta property="og:image" content="https://rlang.r-lib.org/logo.png"><meta name="robots" content="noindex"><script defer data-domain="rlang.r-lib.org,all.tidyverse.org" src="https://plausible.io/js/plausible.js"></script></head><body>
    <a href="#container" class="visually-hidden-focusable">Skip to content</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-none" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">rlang</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">1.1.6.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-tidy-evaluation" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Tidy evaluation</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-tidy-evaluation"><li><h6 class="dropdown-header" data-toc-skip>Overviews</h6></li>
    <li><a class="dropdown-item" href="../reference/topic-data-mask.html">What is data-masking and why do I need `{{`?</a></li>
    <li><a class="dropdown-item" href="../reference/topic-data-mask-programming.html">Data mask programming patterns</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Guides</h6></li>
    <li><a class="dropdown-item" href="../reference/topic-data-mask-ambiguity.html">The data mask ambiguity</a></li>
    <li><a class="dropdown-item" href="../reference/topic-double-evaluation.html">The double evaluation problem</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Notes</h6></li>
    <li><a class="dropdown-item" href="../reference/topic-inject-out-of-context.html">What happens if I use injection operators out of context?</a></li>
    <li><a class="dropdown-item" href="../reference/topic-embrace-non-args.html">Does `{{` work on regular objects?</a></li>
  </ul></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-metaprogramming" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Metaprogramming</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-metaprogramming"><li><h6 class="dropdown-header" data-toc-skip>Overviews</h6></li>
    <li><a class="dropdown-item" href="../reference/topic-defuse.html">Defusing R expressions</a></li>
    <li><a class="dropdown-item" href="../reference/topic-inject.html">Injecting with `!!`, `!!!`, and glue syntax</a></li>
    <li><a class="dropdown-item" href="../reference/topic-metaprogramming.html">Metaprogramming patterns</a></li>
    <li><a class="dropdown-item" href="../reference/topic-quosure.html">What are quosures and when are they needed?</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Guides</h6></li>
    <li><a class="dropdown-item" href="../reference/topic-multiple-columns.html">Taking multiple columns without `...`</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Notes</h6></li>
    <li><a class="dropdown-item" href="../reference/topic-embrace-constants.html">Why are strings and other constants enquosed in the empty environment?</a></li>
  </ul></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-conditions" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Conditions</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-conditions"><li><h6 class="dropdown-header" data-toc-skip>Guides</h6></li>
    <li><a class="dropdown-item" href="../reference/topic-error-call.html">Including function calls in error messages</a></li>
    <li><a class="dropdown-item" href="../reference/topic-error-chaining.html">Including contextual information with error chains</a></li>
    <li><a class="dropdown-item" href="../reference/topic-condition-formatting.html">Formatting messages with cli</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Notes</h6></li>
    <li><a class="dropdown-item" href="../reference/topic-condition-customisation.html">Customising condition messages</a></li>
  </ul></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-news" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">News</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-news"><li><h6 class="dropdown-header" data-toc-skip>Releases</h6></li>
    <li><a class="external-link dropdown-item" href="https://www.tidyverse.org/blog/2020/02/glue-strings-and-tidy-eval/">Version 0.4.3</a></li>
    <li><a class="external-link dropdown-item" href="https://www.tidyverse.org/articles/2019/06/rlang-0-4-0/">Version 0.4.0</a></li>
    <li><a class="external-link dropdown-item" href="https://www.tidyverse.org/articles/2019/01/rlang-0-3-1/">Version 0.3.1</a></li>
    <li><a class="external-link dropdown-item" href="https://www.tidyverse.org/articles/2018/10/rlang-0-3-0/">Version 0.3.0</a></li>
    <li><a class="external-link dropdown-item" href="https://www.tidyverse.org/articles/2018/03/rlang-0.2.0/">Version 0.2.0</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../news/index.html">Changelog</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/r-lib/rlang/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic" id="container">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Name injection with <code>"{"</code> and <code>"{{"</code></h1>
      <small class="dont-index">Source: <a href="https://github.com/r-lib/rlang/blob/main/R/nse-inject.R" class="external-link"><code>R/nse-inject.R</code></a></small>
      <div class="d-none name"><code>glue-operators.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><a href="dyn-dots.html">Dynamic dots</a> (and <a href="topic-data-mask.html">data-masked</a> dots which are dynamic by default) have built-in support for names interpolation with the <a href="https://glue.tidyverse.org/" class="external-link">glue package</a>.</p>
<p></p><div class="sourceCode r"><pre><code><span><span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span>foo <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 1 x 1</span></span>
<span><span class="co">#&gt;     foo</span></span>
<span><span class="co">#&gt;   &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1     1</span></span>
<span></span>
<span><span class="va">foo</span> <span class="op">&lt;-</span> <span class="st">"name"</span></span>
<span><span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span><span class="st">"{foo}"</span> <span class="op">:=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 1 x 1</span></span>
<span><span class="co">#&gt;    name</span></span>
<span><span class="co">#&gt;   &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1     1</span></span></code></pre><p></p></div>
<p>Inside functions, embracing an argument with <code><a href="embrace-operator.html">{{</a></code> inserts the expression supplied as argument in the string. This gives an indication on the variable or computation supplied as argument:</p>
<p></p><div class="sourceCode r"><pre><code><span><span class="va">tib</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span><span class="st">"var: {{ x }}"</span> <span class="op">:=</span> <span class="va">x</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu">tib</span><span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 1 x 1</span></span>
<span><span class="co">#&gt;   `var: 1 + 1`</span></span>
<span><span class="co">#&gt;          &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1            2</span></span></code></pre><p></p></div>
<p>See also <code><a href="englue.html">englue()</a></code> to string-embrace outside of dynamic dots.</p>
<p></p><div class="sourceCode r"><pre><code><span><span class="va">g</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="../reference/englue.html">englue</a></span><span class="op">(</span><span class="st">"var: {{ x }}"</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu">g</span><span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "var: 1 + 1"</span></span></code></pre><p></p></div>
<p>Technically, <code>"{{"</code> <a href="topic-defuse.html">defuses</a> a function argument, calls <code><a href="as_label.html">as_label()</a></code> on the expression supplied as argument, and inserts the result in the string.</p><div class="section">
<h3 id="-and-"><code>"{"</code> and <code>"{{"</code><a class="anchor" aria-label="anchor" href="#-and-"></a></h3>


<p>While <code><a href="https://glue.tidyverse.org/reference/glue.html" class="external-link">glue::glue()</a></code> only supports <code>"{"</code>, dynamic dots support both <code>"{"</code> and <code>"{{"</code>. The double brace variant is similar to the embrace operator <code><a href="embrace-operator.html">{{</a></code> available in <a href="topic-data-mask.html">data-masked</a> arguments.</p>
<p>In the following example, the embrace operator is used in a glue string to name the result with a default name that represents the expression supplied as argument:</p>
<p></p><div class="sourceCode r"><pre><code><span><span class="va">my_mean</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">data</span>, <span class="va">var</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">data</span> <span class="op">%&gt;%</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span><span class="st">"{{ var }}"</span> <span class="op">:=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="op">{</span><span class="op">{</span> <span class="va">var</span> <span class="op">}</span><span class="op">}</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">mtcars</span> <span class="op">%&gt;%</span> <span class="fu">my_mean</span><span class="op">(</span><span class="va">cyl</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 1 x 1</span></span>
<span><span class="co">#&gt;     cyl</span></span>
<span><span class="co">#&gt;   &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1  6.19</span></span>
<span></span>
<span><span class="va">mtcars</span> <span class="op">%&gt;%</span> <span class="fu">my_mean</span><span class="op">(</span><span class="va">cyl</span> <span class="op">*</span> <span class="va">am</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 1 x 1</span></span>
<span><span class="co">#&gt;   `cyl * am`</span></span>
<span><span class="co">#&gt;        &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1       2.06</span></span></code></pre><p></p></div>
<p><code>"{{"</code> is only meant for inserting an expression supplied as argument to a function. The result of the expression is not inspected or used. To interpolate a string stored in a variable, use the regular glue operator <code>"{"</code> instead:</p>
<p></p><div class="sourceCode r"><pre><code><span><span class="va">my_mean</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">data</span>, <span class="va">var</span>, <span class="va">name</span> <span class="op">=</span> <span class="st">"mean"</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">data</span> <span class="op">%&gt;%</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span><span class="st">"{name}"</span> <span class="op">:=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="op">{</span><span class="op">{</span> <span class="va">var</span> <span class="op">}</span><span class="op">}</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">mtcars</span> <span class="op">%&gt;%</span> <span class="fu">my_mean</span><span class="op">(</span><span class="va">cyl</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 1 x 1</span></span>
<span><span class="co">#&gt;    mean</span></span>
<span><span class="co">#&gt;   &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1  6.19</span></span>
<span></span>
<span><span class="va">mtcars</span> <span class="op">%&gt;%</span> <span class="fu">my_mean</span><span class="op">(</span><span class="va">cyl</span>, name <span class="op">=</span> <span class="st">"cyl"</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 1 x 1</span></span>
<span><span class="co">#&gt;     cyl</span></span>
<span><span class="co">#&gt;   &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1  6.19</span></span></code></pre><p></p></div>
<p>Using the wrong operator causes unexpected results:</p>
<p></p><div class="sourceCode r"><pre><code><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="st">"name"</span></span>
<span></span>
<span><span class="fu"><a href="../reference/list2.html">list2</a></span><span class="op">(</span><span class="st">"{{ x }}"</span> <span class="op">:=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="co">#&gt; $`"name"`</span></span>
<span><span class="co">#&gt; [1] 1</span></span>
<span></span>
<span><span class="fu"><a href="../reference/list2.html">list2</a></span><span class="op">(</span><span class="st">"{x}"</span> <span class="op">:=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="co">#&gt; $name</span></span>
<span><span class="co">#&gt; [1] 1</span></span></code></pre><p></p></div>
<p>Ideally, using <code>{{</code> on regular objects would be an error. However for technical reasons it is not possible to make a distinction between function arguments and ordinary variables. See <a href="topic-embrace-non-args.html">Does {{ work on regular objects?</a> for more information about this limitation.</p>
</div>

<div class="section">
<h3 id="allow-overriding-default-names">Allow overriding default names<a class="anchor" aria-label="anchor" href="#allow-overriding-default-names"></a></h3>


<p>The implementation of <code>my_mean()</code> in the previous section forces a default name onto the result. But what if the caller wants to give it a different name? In functions that take dots, it is possible to just supply a named expression to override the default. In a function like <code>my_mean()</code> that takes a named argument we need a different approach.</p>
<p>This is where <code><a href="englue.html">englue()</a></code> becomes useful. We can pull out the default name creation in another user-facing argument like this:</p>
<p></p><div class="sourceCode r"><pre><code><span><span class="va">my_mean</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">data</span>, <span class="va">var</span>, <span class="va">name</span> <span class="op">=</span> <span class="fu"><a href="../reference/englue.html">englue</a></span><span class="op">(</span><span class="st">"{{ var }}"</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">data</span> <span class="op">%&gt;%</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span><span class="st">"{name}"</span> <span class="op">:=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="op">{</span><span class="op">{</span> <span class="va">var</span> <span class="op">}</span><span class="op">}</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre><p></p></div>
<p>Now the user may supply their own name if needed:</p>
<p></p><div class="sourceCode r"><pre><code><span><span class="va">mtcars</span> <span class="op">%&gt;%</span> <span class="fu">my_mean</span><span class="op">(</span><span class="va">cyl</span> <span class="op">*</span> <span class="va">am</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 1 x 1</span></span>
<span><span class="co">#&gt;   `cyl * am`</span></span>
<span><span class="co">#&gt;        &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1       2.06</span></span>
<span></span>
<span><span class="va">mtcars</span> <span class="op">%&gt;%</span> <span class="fu">my_mean</span><span class="op">(</span><span class="va">cyl</span> <span class="op">*</span> <span class="va">am</span>, name <span class="op">=</span> <span class="st">"mean_cyl_am"</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 1 x 1</span></span>
<span><span class="co">#&gt;   mean_cyl_am</span></span>
<span><span class="co">#&gt;         &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1        2.06</span></span></code></pre><p></p></div>
</div>

<div class="section">
<h3 id="what-s-the-deal-with-">What's the deal with <code>:=</code>?<a class="anchor" aria-label="anchor" href="#what-s-the-deal-with-"></a></h3>


<p>Name injection in dynamic dots was originally implemented with <code>:=</code> instead of <code>=</code> to allow complex expressions on the LHS:</p>
<p></p><div class="sourceCode r"><pre><code><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="st">"name"</span></span>
<span><span class="fu"><a href="../reference/list2.html">list2</a></span><span class="op">(</span><span class="op">!</span><span class="op">!</span><span class="va">x</span> <span class="op">:=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="co">#&gt; $name</span></span>
<span><span class="co">#&gt; [1] 1</span></span></code></pre><p></p></div>
<p>Name-injection with glue operations was an extension of this existing feature and so inherited the same interface. However, there is no technical barrier to using glue strings on the LHS of <code>=</code>.</p>
</div>

<div class="section">
<h3 id="using-glue-syntax-in-packages">Using glue syntax in packages<a class="anchor" aria-label="anchor" href="#using-glue-syntax-in-packages"></a></h3>


<p>Since rlang does not depend directly on glue, you will have to ensure that glue is installed by adding it to your <code>Imports:</code> section.</p>
<p></p><div class="sourceCode r"><pre><code><span><span class="fu">usethis</span><span class="fu">::</span><span class="fu"><a href="https://usethis.r-lib.org/reference/use_package.html" class="external-link">use_package</a></span><span class="op">(</span><span class="st">"glue"</span>, <span class="st">"Imports"</span><span class="op">)</span></span></code></pre><p></p></div>
</div>

    </div>



  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


   </div>
  <footer><div class="container">
  <div class="pkgdown-footer-left">
  <p>Developed by <a href="https://github.com/lionel-" class="external-link">Lionel Henry</a>, <a href="https://hadley.nz" class="external-link">Hadley Wickham</a>, <a href="https://www.posit.co" class="external-link"><img src="https://www.tidyverse.org/posit-logo.svg" alt="Posit" height="16" width="62" style="margin-bottom: 3px;"></a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.2.</p>
</div>

  </div></footer></body></html>

