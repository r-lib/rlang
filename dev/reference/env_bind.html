<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Bind symbols to objects in an environment — env_bind • rlang</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Source_Sans_Pro-0.4.10/font.css" rel="stylesheet"><link href="../deps/Source_Code_Pro-0.4.10/font.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Bind symbols to objects in an environment — env_bind"><meta name="description" content="These functions create bindings in an environment. The bindings are
supplied through ... as pairs of names and values or expressions.
env_bind() is equivalent to evaluating a &amp;lt;- expression within
the given environment. This function should take care of the
majority of use cases but the other variants can be useful for
specific problems.
env_bind() takes named values which are bound in .env.
env_bind() is equivalent to base::assign().
env_bind_active() takes named functions and creates active
bindings in .env. This is equivalent to
base::makeActiveBinding(). An active binding executes a
function each time it is evaluated. The arguments are passed to
as_function() so you can supply formulas instead of functions.
Remember that functions are scoped in their own environment.
These functions can thus refer to symbols from this enclosure
that are not actually in scope in the dynamic environment where
the active bindings are invoked. This allows creative solutions
to difficult problems (see the implementations of dplyr::do()
methods for an example).
env_bind_lazy() takes named expressions. This is equivalent
to base::delayedAssign(). The arguments are captured with
exprs() (and thus support call-splicing and unquoting) and
assigned to symbols in .env. These expressions are not
evaluated immediately but lazily. Once a symbol is evaluated, the
corresponding expression is evaluated in turn and its value is
bound to the symbol (the expressions are thus evaluated only
once, if at all).
%&amp;lt;~% is a shortcut for env_bind_lazy(). It works like &amp;lt;-
but the RHS is evaluated lazily.

"><meta property="og:description" content="These functions create bindings in an environment. The bindings are
supplied through ... as pairs of names and values or expressions.
env_bind() is equivalent to evaluating a &amp;lt;- expression within
the given environment. This function should take care of the
majority of use cases but the other variants can be useful for
specific problems.
env_bind() takes named values which are bound in .env.
env_bind() is equivalent to base::assign().
env_bind_active() takes named functions and creates active
bindings in .env. This is equivalent to
base::makeActiveBinding(). An active binding executes a
function each time it is evaluated. The arguments are passed to
as_function() so you can supply formulas instead of functions.
Remember that functions are scoped in their own environment.
These functions can thus refer to symbols from this enclosure
that are not actually in scope in the dynamic environment where
the active bindings are invoked. This allows creative solutions
to difficult problems (see the implementations of dplyr::do()
methods for an example).
env_bind_lazy() takes named expressions. This is equivalent
to base::delayedAssign(). The arguments are captured with
exprs() (and thus support call-splicing and unquoting) and
assigned to symbols in .env. These expressions are not
evaluated immediately but lazily. Once a symbol is evaluated, the
corresponding expression is evaluated in turn and its value is
bound to the symbol (the expressions are thus evaluated only
once, if at all).
%&amp;lt;~% is a shortcut for env_bind_lazy(). It works like &amp;lt;-
but the RHS is evaluated lazily.

"><meta property="og:image" content="https://rlang.r-lib.org/logo.png"><meta name="robots" content="noindex"><script src="https://cdn.jsdelivr.net/gh/posit-dev/supported-by-posit/js/badge.min.js" data-hide-below="1200" data-max-height="43" data-light-bg="#666f76" data-light-fg="#f9f9f9"></script><script defer data-domain="rlang.r-lib.org,all.tidyverse.org" src="https://plausible.io/js/plausible.js"></script></head><body>
    <a href="#container" class="visually-hidden-focusable">Skip to content</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-none" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">rlang</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">1.1.6.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-tidy-evaluation" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Tidy evaluation</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-tidy-evaluation"><li><h6 class="dropdown-header" data-toc-skip>Overviews</h6></li>
    <li><a class="dropdown-item" href="../reference/topic-data-mask.html">What is data-masking and why do I need `{{`?</a></li>
    <li><a class="dropdown-item" href="../reference/topic-data-mask-programming.html">Data mask programming patterns</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Guides</h6></li>
    <li><a class="dropdown-item" href="../reference/topic-data-mask-ambiguity.html">The data mask ambiguity</a></li>
    <li><a class="dropdown-item" href="../reference/topic-double-evaluation.html">The double evaluation problem</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Notes</h6></li>
    <li><a class="dropdown-item" href="../reference/topic-inject-out-of-context.html">What happens if I use injection operators out of context?</a></li>
    <li><a class="dropdown-item" href="../reference/topic-embrace-non-args.html">Does `{{` work on regular objects?</a></li>
  </ul></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-metaprogramming" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Metaprogramming</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-metaprogramming"><li><h6 class="dropdown-header" data-toc-skip>Overviews</h6></li>
    <li><a class="dropdown-item" href="../reference/topic-defuse.html">Defusing R expressions</a></li>
    <li><a class="dropdown-item" href="../reference/topic-inject.html">Injecting with `!!`, `!!!`, and glue syntax</a></li>
    <li><a class="dropdown-item" href="../reference/topic-metaprogramming.html">Metaprogramming patterns</a></li>
    <li><a class="dropdown-item" href="../reference/topic-quosure.html">What are quosures and when are they needed?</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Guides</h6></li>
    <li><a class="dropdown-item" href="../reference/topic-multiple-columns.html">Taking multiple columns without `...`</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Notes</h6></li>
    <li><a class="dropdown-item" href="../reference/topic-embrace-constants.html">Why are strings and other constants enquosed in the empty environment?</a></li>
  </ul></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-conditions" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Conditions</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-conditions"><li><h6 class="dropdown-header" data-toc-skip>Guides</h6></li>
    <li><a class="dropdown-item" href="../reference/topic-error-call.html">Including function calls in error messages</a></li>
    <li><a class="dropdown-item" href="../reference/topic-error-chaining.html">Including contextual information with error chains</a></li>
    <li><a class="dropdown-item" href="../reference/topic-condition-formatting.html">Formatting messages with cli</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Notes</h6></li>
    <li><a class="dropdown-item" href="../reference/topic-condition-customisation.html">Customising condition messages</a></li>
  </ul></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-news" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">News</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-news"><li><h6 class="dropdown-header" data-toc-skip>Releases</h6></li>
    <li><a class="external-link dropdown-item" href="https://www.tidyverse.org/blog/2020/02/glue-strings-and-tidy-eval/">Version 0.4.3</a></li>
    <li><a class="external-link dropdown-item" href="https://www.tidyverse.org/articles/2019/06/rlang-0-4-0/">Version 0.4.0</a></li>
    <li><a class="external-link dropdown-item" href="https://www.tidyverse.org/articles/2019/01/rlang-0-3-1/">Version 0.3.1</a></li>
    <li><a class="external-link dropdown-item" href="https://www.tidyverse.org/articles/2018/10/rlang-0-3-0/">Version 0.3.0</a></li>
    <li><a class="external-link dropdown-item" href="https://www.tidyverse.org/articles/2018/03/rlang-0.2.0/">Version 0.2.0</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../news/index.html">Changelog</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/r-lib/rlang/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic" id="container">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Bind symbols to objects in an environment</h1>
      <small class="dont-index">Source: <a href="https://github.com/r-lib/rlang/blob/main/R/env-binding.R" class="external-link"><code>R/env-binding.R</code></a></small>
      <div class="d-none name"><code>env_bind.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>These functions create bindings in an environment. The bindings are
supplied through <code>...</code> as pairs of names and values or expressions.
<code>env_bind()</code> is equivalent to evaluating a <code>&lt;-</code> expression within
the given environment. This function should take care of the
majority of use cases but the other variants can be useful for
specific problems.</p><ul><li><p><code>env_bind()</code> takes named <em>values</em> which are bound in <code>.env</code>.
<code>env_bind()</code> is equivalent to <code><a href="https://rdrr.io/r/base/assign.html" class="external-link">base::assign()</a></code>.</p></li>
<li><p><code>env_bind_active()</code> takes named <em>functions</em> and creates active
bindings in <code>.env</code>. This is equivalent to
<code><a href="https://rdrr.io/r/base/bindenv.html" class="external-link">base::makeActiveBinding()</a></code>. An active binding executes a
function each time it is evaluated. The arguments are passed to
<code><a href="as_function.html">as_function()</a></code> so you can supply formulas instead of functions.</p>
<p>Remember that functions are scoped in their own environment.
These functions can thus refer to symbols from this enclosure
that are not actually in scope in the dynamic environment where
the active bindings are invoked. This allows creative solutions
to difficult problems (see the implementations of <code><a href="https://dplyr.tidyverse.org/reference/do.html" class="external-link">dplyr::do()</a></code>
methods for an example).</p></li>
<li><p><code>env_bind_lazy()</code> takes named <em>expressions</em>. This is equivalent
to <code><a href="https://rdrr.io/r/base/delayedAssign.html" class="external-link">base::delayedAssign()</a></code>. The arguments are captured with
<code><a href="defusing-advanced.html">exprs()</a></code> (and thus support call-splicing and unquoting) and
assigned to symbols in <code>.env</code>. These expressions are not
evaluated immediately but lazily. Once a symbol is evaluated, the
corresponding expression is evaluated in turn and its value is
bound to the symbol (the expressions are thus evaluated only
once, if at all).</p></li>
<li><p><code>%&lt;~%</code> is a shortcut for <code>env_bind_lazy()</code>. It works like <code>&lt;-</code>
but the RHS is evaluated lazily.</p></li>
</ul></div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">env_bind</span><span class="op">(</span><span class="va">.env</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">env_bind_lazy</span><span class="op">(</span><span class="va">.env</span>, <span class="va">...</span>, .eval_env <span class="op">=</span> <span class="fu"><a href="stack.html">caller_env</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">env_bind_active</span><span class="op">(</span><span class="va">.env</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="va">lhs</span> <span class="op">%&lt;~%</span> <span class="va">rhs</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg--env">.env<a class="anchor" aria-label="anchor" href="#arg--env"></a></dt>
<dd><p>An environment.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>&lt;<a href="dyn-dots.html">dynamic</a>&gt; Named objects (<code>env_bind()</code>),
expressions <code>env_bind_lazy()</code>, or functions (<code>env_bind_active()</code>).
Use <code><a href="zap.html">zap()</a></code> to remove bindings.</p></dd>


<dt id="arg--eval-env">.eval_env<a class="anchor" aria-label="anchor" href="#arg--eval-env"></a></dt>
<dd><p>The environment where the expressions will be
evaluated when the symbols are forced.</p></dd>


<dt id="arg-lhs">lhs<a class="anchor" aria-label="anchor" href="#arg-lhs"></a></dt>
<dd><p>The variable name to which <code>rhs</code> will be lazily assigned.</p></dd>


<dt id="arg-rhs">rhs<a class="anchor" aria-label="anchor" href="#arg-rhs"></a></dt>
<dd><p>An expression lazily evaluated and assigned to <code>lhs</code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>The input object <code>.env</code>, with its associated environment
modified in place, invisibly.</p>
    </div>
    <div class="section level2">
    <h2 id="side-effects">Side effects<a class="anchor" aria-label="anchor" href="#side-effects"></a></h2>



<p>Since environments have reference semantics (see relevant section
in <code><a href="env.html">env()</a></code> documentation), modifying the bindings of an environment
produces effects in all other references to that environment. In
other words, <code>env_bind()</code> and its variants have side effects.</p>
<p>Like other side-effecty functions like <code><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par()</a></code> and <code><a href="https://rdrr.io/r/base/options.html" class="external-link">options()</a></code>,
<code>env_bind()</code> and variants return the old values invisibly.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="env_poke.html">env_poke()</a></code> for binding a single element.</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># env_bind() is a programmatic way of assigning values to symbols</span></span></span>
<span class="r-in"><span><span class="co"># with `&lt;-`. We can add bindings in the current environment:</span></span></span>
<span class="r-in"><span><span class="fu">env_bind</span><span class="op">(</span><span class="fu"><a href="stack.html">current_env</a></span><span class="op">(</span><span class="op">)</span>, foo <span class="op">=</span> <span class="st">"bar"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">foo</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "bar"</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Or modify those bindings:</span></span></span>
<span class="r-in"><span><span class="va">bar</span> <span class="op">&lt;-</span> <span class="st">"bar"</span></span></span>
<span class="r-in"><span><span class="fu">env_bind</span><span class="op">(</span><span class="fu"><a href="stack.html">current_env</a></span><span class="op">(</span><span class="op">)</span>, bar <span class="op">=</span> <span class="st">"BAR"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">bar</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "BAR"</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># You can remove bindings by supplying zap sentinels:</span></span></span>
<span class="r-in"><span><span class="fu">env_bind</span><span class="op">(</span><span class="fu"><a href="stack.html">current_env</a></span><span class="op">(</span><span class="op">)</span>, foo <span class="op">=</span> <span class="fu"><a href="zap.html">zap</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/try.html" class="external-link">try</a></span><span class="op">(</span><span class="va">foo</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Error in eval(expr, envir) : object 'foo' not found</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Unquote-splice a named list of zaps</span></span></span>
<span class="r-in"><span><span class="va">zaps</span> <span class="op">&lt;-</span> <span class="fu"><a href="rep_along.html">rep_named</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"foo"</span>, <span class="st">"bar"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="zap.html">zap</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">env_bind</span><span class="op">(</span><span class="fu"><a href="stack.html">current_env</a></span><span class="op">(</span><span class="op">)</span>, <span class="op">!</span><span class="op">!</span><span class="op">!</span><span class="va">zaps</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/try.html" class="external-link">try</a></span><span class="op">(</span><span class="va">bar</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Error in eval(expr, envir) : object 'bar' not found</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># It is most useful to change other environments:</span></span></span>
<span class="r-in"><span><span class="va">my_env</span> <span class="op">&lt;-</span> <span class="fu"><a href="env.html">env</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">env_bind</span><span class="op">(</span><span class="va">my_env</span>, foo <span class="op">=</span> <span class="st">"foo"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">my_env</span><span class="op">$</span><span class="va">foo</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "foo"</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># A useful feature is to splice lists of named values:</span></span></span>
<span class="r-in"><span><span class="va">vals</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>a <span class="op">=</span> <span class="fl">10</span>, b <span class="op">=</span> <span class="fl">20</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">env_bind</span><span class="op">(</span><span class="va">my_env</span>, <span class="op">!</span><span class="op">!</span><span class="op">!</span><span class="va">vals</span>, c <span class="op">=</span> <span class="fl">30</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">my_env</span><span class="op">$</span><span class="va">b</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 20</span>
<span class="r-in"><span><span class="va">my_env</span><span class="op">$</span><span class="va">c</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 30</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># You can also unquote a variable referring to a symbol or a string</span></span></span>
<span class="r-in"><span><span class="co"># as binding name:</span></span></span>
<span class="r-in"><span><span class="va">var</span> <span class="op">&lt;-</span> <span class="st">"baz"</span></span></span>
<span class="r-in"><span><span class="fu">env_bind</span><span class="op">(</span><span class="va">my_env</span>, <span class="op">!</span><span class="op">!</span><span class="va">var</span> <span class="op">:=</span> <span class="st">"BAZ"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">my_env</span><span class="op">$</span><span class="va">baz</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "BAZ"</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># The old values of the bindings are returned invisibly:</span></span></span>
<span class="r-in"><span><span class="va">old</span> <span class="op">&lt;-</span> <span class="fu">env_bind</span><span class="op">(</span><span class="va">my_env</span>, a <span class="op">=</span> <span class="fl">1</span>, b <span class="op">=</span> <span class="fl">2</span>, baz <span class="op">=</span> <span class="st">"baz"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">old</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $a</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $b</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 20</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $baz</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "BAZ"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># You can restore the original environment state by supplying the</span></span></span>
<span class="r-in"><span><span class="co"># old values back:</span></span></span>
<span class="r-in"><span><span class="fu">env_bind</span><span class="op">(</span><span class="va">my_env</span>, <span class="op">!</span><span class="op">!</span><span class="op">!</span><span class="va">old</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># env_bind_lazy() assigns expressions lazily:</span></span></span>
<span class="r-in"><span><span class="va">env</span> <span class="op">&lt;-</span> <span class="fu"><a href="env.html">env</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">env_bind_lazy</span><span class="op">(</span><span class="va">env</span>, name <span class="op">=</span> <span class="op">{</span> <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"forced!\n"</span><span class="op">)</span>; <span class="st">"value"</span> <span class="op">}</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Referring to the binding will cause evaluation:</span></span></span>
<span class="r-in"><span><span class="va">env</span><span class="op">$</span><span class="va">name</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> forced!</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "value"</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># But only once, subsequent references yield the final value:</span></span></span>
<span class="r-in"><span><span class="va">env</span><span class="op">$</span><span class="va">name</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "value"</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># You can unquote expressions:</span></span></span>
<span class="r-in"><span><span class="va">expr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/substitute.html" class="external-link">quote</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">message</a></span><span class="op">(</span><span class="st">"forced!"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">env_bind_lazy</span><span class="op">(</span><span class="va">env</span>, name <span class="op">=</span> <span class="op">!</span><span class="op">!</span><span class="va">expr</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">env</span><span class="op">$</span><span class="va">name</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> forced!</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> NULL</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># By default the expressions are evaluated in the current</span></span></span>
<span class="r-in"><span><span class="co"># environment. For instance we can create a local binding and refer</span></span></span>
<span class="r-in"><span><span class="co"># to it, even though the variable is bound in a different</span></span></span>
<span class="r-in"><span><span class="co"># environment:</span></span></span>
<span class="r-in"><span><span class="va">who</span> <span class="op">&lt;-</span> <span class="st">"mickey"</span></span></span>
<span class="r-in"><span><span class="fu">env_bind_lazy</span><span class="op">(</span><span class="va">env</span>, name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">who</span>, <span class="st">"mouse"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">env</span><span class="op">$</span><span class="va">name</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "mickey mouse"</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># You can specify another evaluation environment with `.eval_env`:</span></span></span>
<span class="r-in"><span><span class="va">eval_env</span> <span class="op">&lt;-</span> <span class="fu"><a href="env.html">env</a></span><span class="op">(</span>who <span class="op">=</span> <span class="st">"minnie"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">env_bind_lazy</span><span class="op">(</span><span class="va">env</span>, name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">who</span>, <span class="st">"mouse"</span><span class="op">)</span>, .eval_env <span class="op">=</span> <span class="va">eval_env</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">env</span><span class="op">$</span><span class="va">name</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "minnie mouse"</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Or by unquoting a quosure:</span></span></span>
<span class="r-in"><span><span class="va">quo</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/eval.html" class="external-link">local</a></span><span class="op">(</span><span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="va">who</span> <span class="op">&lt;-</span> <span class="st">"fievel"</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="defusing-advanced.html">quo</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">who</span>, <span class="st">"mouse"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">env_bind_lazy</span><span class="op">(</span><span class="va">env</span>, name <span class="op">=</span> <span class="op">!</span><span class="op">!</span><span class="va">quo</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">env</span><span class="op">$</span><span class="va">name</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "fievel mouse"</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># You can create active bindings with env_bind_active(). Active</span></span></span>
<span class="r-in"><span><span class="co"># bindings execute a function each time they are evaluated:</span></span></span>
<span class="r-in"><span><span class="va">fn</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"I have been called\n"</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">env</span> <span class="op">&lt;-</span> <span class="fu"><a href="env.html">env</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">env_bind_active</span><span class="op">(</span><span class="va">env</span>, symbol <span class="op">=</span> <span class="va">fn</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># `fn` is executed each time `symbol` is evaluated or retrieved:</span></span></span>
<span class="r-in"><span><span class="va">env</span><span class="op">$</span><span class="va">symbol</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> I have been called</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] -0.0499649</span>
<span class="r-in"><span><span class="va">env</span><span class="op">$</span><span class="va">symbol</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> I have been called</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] -0.2514834</span>
<span class="r-in"><span><span class="fu"><a href="eval_bare.html">eval_bare</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/substitute.html" class="external-link">quote</a></span><span class="op">(</span><span class="va">symbol</span><span class="op">)</span>, <span class="va">env</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> I have been called</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.4447971</span>
<span class="r-in"><span><span class="fu"><a href="eval_bare.html">eval_bare</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/substitute.html" class="external-link">quote</a></span><span class="op">(</span><span class="va">symbol</span><span class="op">)</span>, <span class="va">env</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> I have been called</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 2.755418</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># All arguments are passed to as_function() so you can use the</span></span></span>
<span class="r-in"><span><span class="co"># formula shortcut:</span></span></span>
<span class="r-in"><span><span class="fu">env_bind_active</span><span class="op">(</span><span class="va">env</span>, foo <span class="op">=</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">env</span><span class="op">$</span><span class="va">foo</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.5185566</span>
<span class="r-in"><span><span class="va">env</span><span class="op">$</span><span class="va">foo</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.8461201</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


   </div>
  <footer><div class="container">
  <div class="pkgdown-footer-left">
  <p>Developed by <a href="https://github.com/lionel-" class="external-link">Lionel Henry</a>, <a href="https://hadley.nz" class="external-link">Hadley Wickham</a>, <a href="https://www.posit.co" class="external-link"><img src="https://www.tidyverse.org/posit-logo.svg" alt="Posit" height="16" width="62" style="margin-bottom: 3px;"></a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

  </div></footer></body></html>

