<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Condition formatting is a set of operations applied to raw inputs for error messages that includes:
Transforming a character vector of lines to a width-wrapped list of error bullets. This makes it easy to write messages in a list format where each bullet conveys a single important point.
abort(c(
  &quot;The error header&quot;,
  &quot;*&quot; = &quot;An error bullet&quot;,
  &quot;i&quot; = &quot;An info bullet&quot;,
  &quot;x&quot; = &quot;A cross bullet&quot;
))
#&amp;gt; Error:
#&amp;gt; ! The error header
#&amp;gt; * An error bullet
#&amp;gt; i An info bullet
#&amp;gt; x A cross bullet

See the tidyverse error style guide for more about this style of error messaging.
Applying style (emphasis, boldness, ...) and colours to message elements.


While the rlang package embeds rudimentary formatting routines, the main formatting engine is implemented in the cli package.
Formatting messages with cli


By default, rlang uses an internal mechanism to format bullets. It is preferable to delegate formatting to the cli package by using cli::cli_abort(), cli::cli_warn(), and cli::cli_inform() instead of the rlang versions. These wrappers enable cli formatting with sophisticated paragraph wrapping and bullet indenting that make long lines easier to read. In the following example, a long ! bullet is broken with an indented newline:
rlang::global_entrace(class = &quot;errorr&quot;)
#&amp;gt; Error in `rlang::global_entrace()`:
#&amp;gt; ! `class` must be one of &quot;error&quot;, &quot;warning&quot;, or &quot;message&quot;,
#&amp;gt;   not &quot;errorr&quot;.
#&amp;gt; i Did you mean &quot;error&quot;?

The cli wrappers also add many features such as interpolation, semantic formatting of text elements, and pluralisation:
inform_marbles &amp;lt;- function(n_marbles) {
  cli::cli_inform(c(
    &quot;i&quot; = &quot;I have {n_marbles} shiny marble{?s} in my bag.&quot;,
    &quot;v&quot; = &quot;Way to go {.code cli::cli_inform()}!&quot;
  ))
}

inform_marbles(1)
#&amp;gt; i I have 1 shiny marble in my bag.
#&amp;gt; v Way to go `cli::cli_inform()`!

inform_marbles(2)
#&amp;gt; i I have 2 shiny marbles in my bag.
#&amp;gt; v Way to go `cli::cli_inform()`!




Transitioning from abort() to cli_abort()


If you plan to mass-rename calls from abort() to cli::cli_abort(), be careful if you assemble error messages from user inputs. If these individual pieces contain cli or glue syntax, this will result in hard-to-debug errors and possibly unexpected behaviour.
user_input &amp;lt;- &quot;{base::stop('Wrong message.', call. = FALSE)}&quot;
cli::cli_abort(sprintf(&quot;Can't handle input `%s`.&quot;, user_input))
#&amp;gt; Error: Wrong message.

To avoid this, protect your error messages by using cli to assemble the pieces:
user_input &amp;lt;- &quot;{base::stop('Wrong message.', call. = FALSE)}&quot;
cli::cli_abort(&quot;Can't handle input {.code {user_input}}.&quot;)
#&amp;gt; Error:
#&amp;gt; ! Can't handle input `{base::stop('Wrong message.', call. = FALSE)}`.




Enabling cli formatting globally


To enable cli formatting for all abort() calls in your namespace, call local_use_cli() in the onLoad hook of your package. Using on_load() (make sure to call run_on_load() in your hook):
on_load(local_use_cli())

Enabling cli formatting in abort() is useful for:
Transitioning from abort() to cli::cli_abort() progressively.
Using abort() when you'd like to disable interpolation syntax.
Creating error conditions with error_cnd(). These condition messages will be automatically formatted with cli as well.



"><title>Formatting messages with cli — topic-condition-formatting • rlang</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.1.3/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.1.3/bootstrap.bundle.min.js"></script><link href="../deps/Source_Sans_Pro-0.4.2/font.css" rel="stylesheet"><link href="../deps/Source_Code_Pro-0.4.2/font.css" rel="stylesheet"><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Formatting messages with cli — topic-condition-formatting"><meta property="og:description" content="Condition formatting is a set of operations applied to raw inputs for error messages that includes:
Transforming a character vector of lines to a width-wrapped list of error bullets. This makes it easy to write messages in a list format where each bullet conveys a single important point.
abort(c(
  &quot;The error header&quot;,
  &quot;*&quot; = &quot;An error bullet&quot;,
  &quot;i&quot; = &quot;An info bullet&quot;,
  &quot;x&quot; = &quot;A cross bullet&quot;
))
#&amp;gt; Error:
#&amp;gt; ! The error header
#&amp;gt; * An error bullet
#&amp;gt; i An info bullet
#&amp;gt; x A cross bullet

See the tidyverse error style guide for more about this style of error messaging.
Applying style (emphasis, boldness, ...) and colours to message elements.


While the rlang package embeds rudimentary formatting routines, the main formatting engine is implemented in the cli package.
Formatting messages with cli


By default, rlang uses an internal mechanism to format bullets. It is preferable to delegate formatting to the cli package by using cli::cli_abort(), cli::cli_warn(), and cli::cli_inform() instead of the rlang versions. These wrappers enable cli formatting with sophisticated paragraph wrapping and bullet indenting that make long lines easier to read. In the following example, a long ! bullet is broken with an indented newline:
rlang::global_entrace(class = &quot;errorr&quot;)
#&amp;gt; Error in `rlang::global_entrace()`:
#&amp;gt; ! `class` must be one of &quot;error&quot;, &quot;warning&quot;, or &quot;message&quot;,
#&amp;gt;   not &quot;errorr&quot;.
#&amp;gt; i Did you mean &quot;error&quot;?

The cli wrappers also add many features such as interpolation, semantic formatting of text elements, and pluralisation:
inform_marbles &amp;lt;- function(n_marbles) {
  cli::cli_inform(c(
    &quot;i&quot; = &quot;I have {n_marbles} shiny marble{?s} in my bag.&quot;,
    &quot;v&quot; = &quot;Way to go {.code cli::cli_inform()}!&quot;
  ))
}

inform_marbles(1)
#&amp;gt; i I have 1 shiny marble in my bag.
#&amp;gt; v Way to go `cli::cli_inform()`!

inform_marbles(2)
#&amp;gt; i I have 2 shiny marbles in my bag.
#&amp;gt; v Way to go `cli::cli_inform()`!




Transitioning from abort() to cli_abort()


If you plan to mass-rename calls from abort() to cli::cli_abort(), be careful if you assemble error messages from user inputs. If these individual pieces contain cli or glue syntax, this will result in hard-to-debug errors and possibly unexpected behaviour.
user_input &amp;lt;- &quot;{base::stop('Wrong message.', call. = FALSE)}&quot;
cli::cli_abort(sprintf(&quot;Can't handle input `%s`.&quot;, user_input))
#&amp;gt; Error: Wrong message.

To avoid this, protect your error messages by using cli to assemble the pieces:
user_input &amp;lt;- &quot;{base::stop('Wrong message.', call. = FALSE)}&quot;
cli::cli_abort(&quot;Can't handle input {.code {user_input}}.&quot;)
#&amp;gt; Error:
#&amp;gt; ! Can't handle input `{base::stop('Wrong message.', call. = FALSE)}`.




Enabling cli formatting globally


To enable cli formatting for all abort() calls in your namespace, call local_use_cli() in the onLoad hook of your package. Using on_load() (make sure to call run_on_load() in your hook):
on_load(local_use_cli())

Enabling cli formatting in abort() is useful for:
Transitioning from abort() to cli::cli_abort() progressively.
Using abort() when you'd like to disable interpolation syntax.
Creating error conditions with error_cnd(). These condition messages will be automatically formatted with cli as well.



"><meta property="og:image" content="https://rlang.r-lib.org/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><script defer data-domain="rlang.r-lib.org,all.tidyverse.org" src="https://plausible.io/js/plausible.js"></script></head><body>
    <a href="#container" class="visually-hidden-focusable">Skip to content</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-none"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">rlang</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">1.0.4</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-tidy-evaluation">Tidy evaluation</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-tidy-evaluation">
    <h6 class="dropdown-header" data-toc-skip>Overviews</h6>
    <a class="dropdown-item" href="../reference/topic-data-mask.html">What is data-masking and why do I need `{{`?</a>
    <a class="dropdown-item" href="../reference/topic-data-mask-programming.html">Data mask programming patterns</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Guides</h6>
    <a class="dropdown-item" href="../reference/topic-data-mask-ambiguity.html">The data mask ambiguity</a>
    <a class="dropdown-item" href="../reference/topic-double-evaluation.html">The double evaluation problem</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Notes</h6>
    <a class="dropdown-item" href="../reference/topic-inject-out-of-context.html">What happens if I use injection operators out of context?</a>
    <a class="dropdown-item" href="../reference/topic-embrace-non-args.html">Does `{{` work on regular objects?</a>
  </div>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-metaprogramming">Metaprogramming</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-metaprogramming">
    <h6 class="dropdown-header" data-toc-skip>Overviews</h6>
    <a class="dropdown-item" href="../reference/topic-defuse.html">Defusing R expressions</a>
    <a class="dropdown-item" href="../reference/topic-inject.html">Injecting with `!!`, `!!!`, and glue syntax</a>
    <a class="dropdown-item" href="../reference/topic-metaprogramming.html">Metaprogramming patterns</a>
    <a class="dropdown-item" href="../reference/topic-quosure.html">What are quosures and when are they needed?</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Guides</h6>
    <a class="dropdown-item" href="../reference/topic-multiple-columns.html">Taking multiple columns without `...`</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Notes</h6>
    <a class="dropdown-item" href="../reference/topic-embrace-constants.html">Why are strings and other constants enquosed in the empty environment?</a>
  </div>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-conditions">Conditions</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-conditions">
    <h6 class="dropdown-header" data-toc-skip>Guides</h6>
    <a class="dropdown-item" href="../reference/topic-error-call.html">Including function calls in error messages</a>
    <a class="dropdown-item" href="../reference/topic-error-chaining.html">Including contextual information with error chains</a>
    <a class="dropdown-item" href="../reference/topic-condition-formatting.html">Formatting messages with cli</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Notes</h6>
    <a class="dropdown-item" href="../reference/topic-condition-customisation.html">Customising condition messages</a>
  </div>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-news">News</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-news">
    <h6 class="dropdown-header" data-toc-skip>Release notes</h6>
    <a class="external-link dropdown-item" href="https://www.tidyverse.org/blog/2020/02/glue-strings-and-tidy-eval/">Version 0.4.3</a>
    <a class="external-link dropdown-item" href="https://www.tidyverse.org/articles/2019/06/rlang-0-4-0/">Version 0.4.0</a>
    <a class="external-link dropdown-item" href="https://www.tidyverse.org/articles/2019/01/rlang-0-3-1/">Version 0.3.1</a>
    <a class="external-link dropdown-item" href="https://www.tidyverse.org/articles/2018/10/rlang-0-3-0/">Version 0.3.0</a>
    <a class="external-link dropdown-item" href="https://www.tidyverse.org/articles/2018/03/rlang-0.2.0/">Version 0.2.0</a>
    <div class="dropdown-divider"></div>
    <a class="dropdown-item" href="../news/index.html">Changelog</a>
  </div>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/r-lib/rlang/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic" id="container">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Formatting messages with cli</h1>
      <small class="dont-index">Source: <a href="https://github.com/r-lib/rlang/blob/HEAD/R/topic-errors.R" class="external-link"><code>R/topic-errors.R</code></a></small>
      <div class="d-none name"><code>topic-condition-formatting.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Condition formatting is a set of operations applied to raw inputs for error messages that includes:</p><ul><li><p>Transforming a character vector of lines to a width-wrapped list of error bullets. This makes it easy to write messages in a list format where each bullet conveys a single important point.</p>
<p></p><div class="sourceCode r"><pre><code><span><span class="fu"><a href="../reference/abort.html">abort</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="st">"The error header"</span>,</span>
<span>  <span class="st">"*"</span> <span class="op">=</span> <span class="st">"An error bullet"</span>,</span>
<span>  <span class="st">"i"</span> <span class="op">=</span> <span class="st">"An info bullet"</span>,</span>
<span>  <span class="st">"x"</span> <span class="op">=</span> <span class="st">"A cross bullet"</span></span>
<span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Error:</span></span>
<span><span class="co">#&gt; ! The error header</span></span>
<span><span class="co">#&gt; * An error bullet</span></span>
<span><span class="co">#&gt; i An info bullet</span></span>
<span><span class="co">#&gt; x A cross bullet</span></span></code></pre><p></p></div>
<p>See the <a href="https://style.tidyverse.org/error-messages.html" class="external-link">tidyverse error style guide</a> for more about this style of error messaging.</p></li>
<li><p>Applying style (emphasis, boldness, ...) and colours to message elements.</p></li>
</ul><p>While the rlang package embeds rudimentary formatting routines, the main formatting engine is implemented in the <a href="https://cli.r-lib.org/" class="external-link">cli package</a>.</p><div class="section">
<h3 id="formatting-messages-with-cli">Formatting messages with cli<a class="anchor" aria-label="anchor" href="#formatting-messages-with-cli"></a></h3>


<p>By default, rlang uses an internal mechanism to format bullets. It is preferable to delegate formatting to the <a href="https://cli.r-lib.org/" class="external-link">cli package</a> by using <code><a href="https://cli.r-lib.org/reference/cli_abort.html" class="external-link">cli::cli_abort()</a></code>, <code><a href="https://cli.r-lib.org/reference/cli_abort.html" class="external-link">cli::cli_warn()</a></code>, and <code><a href="https://cli.r-lib.org/reference/cli_abort.html" class="external-link">cli::cli_inform()</a></code> instead of the rlang versions. These wrappers enable cli formatting with sophisticated paragraph wrapping and bullet indenting that make long lines easier to read. In the following example, a long <code>!</code> bullet is broken with an indented newline:</p>
<p></p><div class="sourceCode r"><pre><code><span><span class="fu">rlang</span><span class="fu">::</span><span class="fu"><a href="../reference/global_entrace.html">global_entrace</a></span><span class="op">(</span>class <span class="op">=</span> <span class="st">"errorr"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Error in `rlang::global_entrace()`:</span></span>
<span><span class="co">#&gt; ! `class` must be one of "error", "warning", or "message",</span></span>
<span><span class="co">#&gt;   not "errorr".</span></span>
<span><span class="co">#&gt; i Did you mean "error"?</span></span></code></pre><p></p></div>
<p>The cli wrappers also add many features such as interpolation, semantic formatting of text elements, and pluralisation:</p>
<p></p><div class="sourceCode r"><pre><code><span><span class="va">inform_marbles</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">n_marbles</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu">cli</span><span class="fu">::</span><span class="fu"><a href="https://cli.r-lib.org/reference/cli_abort.html" class="external-link">cli_inform</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    <span class="st">"i"</span> <span class="op">=</span> <span class="st">"I have {n_marbles} shiny marble{?s} in my bag."</span>,</span>
<span>    <span class="st">"v"</span> <span class="op">=</span> <span class="st">"Way to go {.code cli::cli_inform()}!"</span></span>
<span>  <span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu">inform_marbles</span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="co">#&gt; i I have 1 shiny marble in my bag.</span></span>
<span><span class="co">#&gt; v Way to go `cli::cli_inform()`!</span></span>
<span></span>
<span><span class="fu">inform_marbles</span><span class="op">(</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="co">#&gt; i I have 2 shiny marbles in my bag.</span></span>
<span><span class="co">#&gt; v Way to go `cli::cli_inform()`!</span></span></code></pre><p></p></div>
</div>

<div class="section">
<h3 id="transitioning-from-abort-to-cli-abort-">Transitioning from <code><a href="abort.html">abort()</a></code> to <code>cli_abort()</code><a class="anchor" aria-label="anchor" href="#transitioning-from-abort-to-cli-abort-"></a></h3>


<p>If you plan to mass-rename calls from <code><a href="abort.html">abort()</a></code> to <code><a href="https://cli.r-lib.org/reference/cli_abort.html" class="external-link">cli::cli_abort()</a></code>, be careful if you assemble error messages from user inputs. If these individual pieces contain cli or glue syntax, this will result in hard-to-debug errors and possibly <a href="https://xkcd.com/327/" class="external-link">unexpected behaviour</a>.</p>
<p></p><div class="sourceCode r"><pre><code><span><span class="va">user_input</span> <span class="op">&lt;-</span> <span class="st">"{base::stop('Wrong message.', call. = FALSE)}"</span></span>
<span><span class="fu">cli</span><span class="fu">::</span><span class="fu"><a href="https://cli.r-lib.org/reference/cli_abort.html" class="external-link">cli_abort</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"Can't handle input `%s`."</span>, <span class="va">user_input</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Error: Wrong message.</span></span></code></pre><p></p></div>
<p>To avoid this, protect your error messages by using cli to assemble the pieces:</p>
<p></p><div class="sourceCode r"><pre><code><span><span class="va">user_input</span> <span class="op">&lt;-</span> <span class="st">"{base::stop('Wrong message.', call. = FALSE)}"</span></span>
<span><span class="fu">cli</span><span class="fu">::</span><span class="fu"><a href="https://cli.r-lib.org/reference/cli_abort.html" class="external-link">cli_abort</a></span><span class="op">(</span><span class="st">"Can't handle input {.code {user_input}}."</span><span class="op">)</span></span>
<span><span class="co">#&gt; Error:</span></span>
<span><span class="co">#&gt; ! Can't handle input `{base::stop('Wrong message.', call. = FALSE)}`.</span></span></code></pre><p></p></div>
</div>

<div class="section">
<h3 id="enabling-cli-formatting-globally">Enabling cli formatting globally<a class="anchor" aria-label="anchor" href="#enabling-cli-formatting-globally"></a></h3>


<p>To enable cli formatting for all <code><a href="abort.html">abort()</a></code> calls in your namespace, call <code><a href="local_use_cli.html">local_use_cli()</a></code> in the <code>onLoad</code> hook of your package. Using <code><a href="on_load.html">on_load()</a></code> (make sure to call <code><a href="on_load.html">run_on_load()</a></code> in your hook):</p>
<p></p><div class="sourceCode r"><pre><code><span><span class="fu"><a href="../reference/on_load.html">on_load</a></span><span class="op">(</span><span class="fu"><a href="../reference/local_use_cli.html">local_use_cli</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre><p></p></div>
<p>Enabling cli formatting in <code><a href="abort.html">abort()</a></code> is useful for:</p><ul><li><p>Transitioning from <code><a href="abort.html">abort()</a></code> to <code><a href="https://cli.r-lib.org/reference/cli_abort.html" class="external-link">cli::cli_abort()</a></code> progressively.</p></li>
<li><p>Using <code><a href="abort.html">abort()</a></code> when you'd like to disable interpolation syntax.</p></li>
<li><p>Creating error conditions with <code><a href="cnd.html">error_cnd()</a></code>. These condition messages will be automatically formatted with cli as well.</p></li>
</ul></div>

    </div>



  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


   </div>
  <footer><div class="container">
  <div class="pkgdown-footer-left">
  <p></p><p>Developed by <a href="https://github.com/lionel-" class="external-link">Lionel Henry</a>, <a href="http://hadley.nz" class="external-link">Hadley Wickham</a>, <a href="https://www.rstudio.com" class="external-link"><img src="https://www.tidyverse.org/rstudio-logo.svg" alt="RStudio" width="72"></a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

  </div></footer></body></html>

