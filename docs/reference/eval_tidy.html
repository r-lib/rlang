<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Evaluate an expression tidily — eval_tidy • rlang</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>

<!-- Bootstrap -->
<link href="../tidyverse.css" rel="stylesheet">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">

<!-- tidyverse -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script>
<script src="../pkgdown.js"></script>

<!-- mathjax -->
<script src='https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>

      <div class="navbar-brand-container">
        <a class="navbar-brand" href="../index.html">rlang</a>
        <small class="tidyverse">part of the <a href="http://tidyverse.org">tidyverse</a></small>
      </div>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/tidy-evaluation.html">Tidy evaluation</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

      <div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Evaluate an expression tidily</h1>
    </div>

    
    <p><code>eval_tidy()</code> is a variant of <code><a href='http://www.rdocumentation.org/packages/base/topics/eval'>base::eval()</a></code> and <code><a href='eval_bare.html'>eval_bare()</a></code> that
powers the <a href = 'http://rlang.tidyverse.org/articles/tidy-evaluation.html'>tidy evaluationframework</a>.
It evaluates <code>expr</code> in an <a href='as_overscope.html'>overscope</a> where the
special definitions enabling tidy evaluation are installed. This
enables the following features:</p><ul>
<li><p>Overscoped data. You can supply a data frame or list of named
vectors to the <code>data</code> argument. The data contained in this list
has precedence over the objects in the contextual environment.
This is similar to how <code><a href='http://www.rdocumentation.org/packages/base/topics/eval'>base::eval()</a></code> accepts a list instead of
an environment.</p></li>
<li><p>Self-evaluation of quosures. Within the overscope, quosures act
like promises. When a quosure within an expression is evaluated,
it automatically invokes the quoted expression in the captured
environment (chained to the overscope). Note that quosures do not
always get evaluated because of lazy semantics, e.g. <code>TRUE || ~never_called</code>.</p></li>
<li><p>Pronouns. <code>eval_tidy()</code> installs the <code>.env</code> and <code>.data</code>
pronouns. <code>.env</code> contains a reference to the calling environment,
while <code>.data</code> refers to the <code>data</code> argument. These pronouns lets
you be explicit about where to find values and throw errors if
you try to access non-existent values.</p></li>
</ul>
    

    <pre class="usage"><span class='fu'>eval_tidy</span>(<span class='no'>expr</span>, <span class='kw'>data</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>env</span> <span class='kw'>=</span> <span class='fu'><a href='caller_env.html'>caller_env</a></span>())</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a> Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>expr</th>
      <td><p>An expression.</p></td>
    </tr>
    <tr>
      <th>data</th>
      <td><p>A list (or data frame). This is passed to the
<code><a href='dictionary.html'>as_dictionary()</a></code> coercer, a generic used to transform an object
to a proper data source. If you want to make <code>eval_tidy()</code> work
for your own objects, you can define a method for this generic.</p></td>
    </tr>
    <tr>
      <th>env</th>
      <td><p>The lexical environment in which to evaluate <code>expr</code>.</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <p><code><a href='quosure.html'>quo()</a></code>, <a href='quasiquotation.html'>quasiquotation</a></p>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'># Like base::eval() and eval_bare(), eval_tidy() evaluates quoted</span>
<span class='co'># expressions:</span>
<span class='no'>expr</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='expr.html'>expr</a></span>(<span class='fl'>1</span> + <span class='fl'>2</span> + <span class='fl'>3</span>)
<span class='fu'>eval_tidy</span>(<span class='no'>expr</span>)</div><div class='output co'>#&gt; [1] 6</div><div class='input'>
<span class='co'># Like base::eval(), it lets you supply overscoping data:</span>
<span class='no'>foo</span> <span class='kw'>&lt;-</span> <span class='fl'>1</span>
<span class='no'>bar</span> <span class='kw'>&lt;-</span> <span class='fl'>2</span>
<span class='no'>expr</span> <span class='kw'>&lt;-</span> <span class='fu'>quote</span>(<span class='fu'>list</span>(<span class='no'>foo</span>, <span class='no'>bar</span>))
<span class='fu'>eval_tidy</span>(<span class='no'>expr</span>, <span class='fu'>list</span>(<span class='kw'>foo</span> <span class='kw'>=</span> <span class='fl'>100</span>))</div><div class='output co'>#&gt; [[1]]
#&gt; [1] 100
#&gt; 
#&gt; [[2]]
#&gt; [1] 2
#&gt; </div><div class='input'>
<span class='co'># The main difference is that quosures self-evaluate within</span>
<span class='co'># eval_tidy():</span>
<span class='no'>quo</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='quosure.html'>quo</a></span>(<span class='fl'>1</span> + <span class='fl'>2</span> + <span class='fl'>3</span>)
<span class='fu'>eval</span>(<span class='no'>quo</span>)</div><div class='output co'>#&gt; &lt;quosure: local&gt;
#&gt; ~1 + 2 + 3</div><div class='input'><span class='fu'>eval_tidy</span>(<span class='no'>quo</span>)</div><div class='output co'>#&gt; [1] 6</div><div class='input'>
<span class='co'># Quosures also self-evaluate deep in an expression not just when</span>
<span class='co'># directly supplied to eval_tidy():</span>
<span class='no'>expr</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='expr.html'>expr</a></span>(<span class='fu'>list</span>(<span class='fu'>list</span>(<span class='fu'>list</span>(!! <span class='no'>quo</span>))))
<span class='fu'>eval</span>(<span class='no'>expr</span>)</div><div class='output co'>#&gt; [[1]]
#&gt; [[1]][[1]]
#&gt; [[1]][[1]][[1]]
#&gt; &lt;quosure: local&gt;
#&gt; ~1 + 2 + 3
#&gt; 
#&gt; 
#&gt; </div><div class='input'><span class='fu'>eval_tidy</span>(<span class='no'>expr</span>)</div><div class='output co'>#&gt; [[1]]
#&gt; [[1]][[1]]
#&gt; [[1]][[1]][[1]]
#&gt; [1] 6
#&gt; 
#&gt; 
#&gt; </div><div class='input'>
<span class='co'># Self-evaluation of quosures is powerful because they</span>
<span class='co'># automatically capture their enclosing environment:</span>
<span class='no'>foo</span> <span class='kw'>&lt;-</span> <span class='kw'>function</span>(<span class='no'>x</span>) {
  <span class='no'>y</span> <span class='kw'>&lt;-</span> <span class='fl'>10</span>
  <span class='fu'><a href='quosure.html'>quo</a></span>(<span class='no'>x</span> + <span class='no'>y</span>)
}
<span class='no'>f</span> <span class='kw'>&lt;-</span> <span class='fu'>foo</span>(<span class='fl'>1</span>)

<span class='co'># This quosure refers to `x` and `y` from `foo()`'s evaluation</span>
<span class='co'># frame. That's evaluated consistently by eval_tidy():</span>
<span class='no'>f</span></div><div class='output co'>#&gt; &lt;quosure: local&gt;
#&gt; ~x + y</div><div class='input'><span class='fu'>eval_tidy</span>(<span class='no'>f</span>)</div><div class='output co'>#&gt; [1] 11</div><div class='input'>

<span class='co'># Finally, eval_tidy() installs handy pronouns that allows users to</span>
<span class='co'># be explicit about where to find symbols. If you supply data,</span>
<span class='co'># eval_tidy() will look there first:</span>
<span class='no'>cyl</span> <span class='kw'>&lt;-</span> <span class='fl'>10</span>
<span class='fu'>eval_tidy</span>(<span class='fu'><a href='quosure.html'>quo</a></span>(<span class='no'>cyl</span>), <span class='no'>mtcars</span>)</div><div class='output co'>#&gt;  [1] 6 6 4 6 8 6 8 4 4 6 6 8 8 8 8 8 8 4 4 4 4 8 8 8 8 4 4 4 8 6 8 4</div><div class='input'>
<span class='co'># To avoid ambiguity and be explicit, you can use the `.env` and</span>
<span class='co'># `.data` pronouns:</span>
<span class='fu'>eval_tidy</span>(<span class='fu'><a href='quosure.html'>quo</a></span>(<span class='no'>.data</span>$<span class='no'>cyl</span>), <span class='no'>mtcars</span>)</div><div class='output co'>#&gt;  [1] 6 6 4 6 8 6 8 4 4 6 6 8 8 8 8 8 8 4 4 4 4 8 8 8 8 4 4 4 8 6 8 4</div><div class='input'><span class='fu'>eval_tidy</span>(<span class='fu'><a href='quosure.html'>quo</a></span>(<span class='no'>.env</span>$<span class='no'>cyl</span>), <span class='no'>mtcars</span>)</div><div class='output co'>#&gt; [1] 10</div><div class='input'>
<span class='co'># Note that instead of using `.env` it is often equivalent to</span>
<span class='co'># unquote a value. The only difference is the timing of evaluation</span>
<span class='co'># since unquoting happens earlier (when the quosure is created):</span>
<span class='fu'>eval_tidy</span>(<span class='fu'><a href='quosure.html'>quo</a></span>(!! <span class='no'>cyl</span>), <span class='no'>mtcars</span>)</div><div class='output co'>#&gt; [1] 10</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#see-also">See also</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>

      <footer>
      <div class="tidyverse">
  <p>rlang is a part of the <strong>tidyverse</strong>, an ecosystem of packages designed with common APIs and a shared philosophy. Learn more at <a href="http://tidyverse.org">tidyverse.org</a>.</p>
</div>

<div class="author">
  <p>Developed by Lionel Henry, <a href='http://hadley.nz'>Hadley Wickham</a>.</p>
  <p>Site built by <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-67989-18', 'auto');
  ga('send', 'pageview');
</script>
      </footer>
   </div>

  </body>
</html>
